<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace属性：用于指定当前的映射文件和哪个接口进行映射，所以需要指定接口的文件路径，故需标注包的完整结构-->
<mapper namespace="com.cy.store.mapper.OrderMapper">

    <resultMap id="OrderEntityMap" type="com.cy.store.entity.Order">
        <!--将表的字段和类的属性 不一致 的字段进行匹配指定，一致的则可以省略不写-->
        <!--column属性：表中字段名 property属性：类中属性名 两者配合完成名称不一致的映射-->
        <!--定义映射规则时，主键不允许省略！注意检查所有在表中出现过的column！-->
        <id column="oid" property="oid"></id> <!--t_address表的主键是aid-->
        <result column="recv_name" property="recvName"></result>
        <result column="province_code" property="provinceCode"></result>
        <result column="recv_phone" property="recvPhone"></result>
        <result column="recv_province" property="recvProvince"></result>
        <result column="recv_city" property="recvCity"></result>
        <result column="recv_area" property="recvArea"></result>
        <result column="recv_address" property="recvAddress"></result>
        <result column="total_price" property="totalPrice"></result>
        <result column="order_time" property="orderTime"></result>
        <result column="pay_time" property="payTime"></result>
        <result column="created_user" property="createdUser"></result>
        <result column="created_time" property="createdTime"></result>
        <result column="modified_user" property="modifiedUser"></result>
        <result column="modified_time" property="modifiedTime"></result>
    </resultMap>

    <insert id="insertOrder" useGeneratedKeys="true" keyProperty="oid">
        INSERT INTO t_order (
            uid,
            recv_name,
            recv_phone,
            recv_province,
            recv_city,
            recv_area,
            recv_address,
            total_price,
            status,
            order_time,
            pay_time,
            created_user,
            created_time,
            modified_user,
            modified_time
        ) VALUES (
            #{uid},
            #{recvName},
            #{recvPhone},
            #{recvProvince},
            #{recvCity},
            #{recvArea},
            #{recvAddress},
            #{totalPrice},
            #{status},
            #{orderTime},
            #{payTime},
            #{createdUser},
            #{createdTime},
            #{modifiedUser},
            #{modifiedTime}
        )
    </insert>

    <insert id="insertOrderItem" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO t_order_item (
            oid,
            pid,
            title,
            image,
            price,
            num,
            created_user,
            created_time,
            modified_user,
            modified_time
        ) VALUES (
            #{oid},
            #{pid},
            #{title},
            #{image},
            #{price},
            #{num},
            #{createdUser},
            #{createdTime},
            #{modifiedUser},
            #{modifiedTime}
        )
    </insert>
    
</mapper>